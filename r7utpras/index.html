<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Data Display</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2 {
            color: #333;
        }
        #sheetSelector {
            margin-bottom: 20px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>Excel Data Display</h1>
    <select id="sheetSelector"></select>
    <div id="dataDisplay"></div>

    <script>
        const workbook = JSON.parse(localStorage.getItem('excelData'));
        const sheetSelector = document.getElementById('sheetSelector');
        const dataDisplay = document.getElementById('dataDisplay');

        function populateSheetSelector() {
            for (let sheetName of workbook.SheetNames) {
                const option = document.createElement('option');
                option.value = sheetName;
                option.textContent = sheetName;
                sheetSelector.appendChild(option);
            }
        }

        function displaySheetData(sheetName) {
            const sheet = workbook.Sheets[sheetName];
            const data = XLSX.utils.sheet_to_json(sheet, {header: 1});

            let html = `<h2>${sheetName}</h2><table>`;

            for (let i = 0; i < data.length; i++) {
                html += '<tr>';
                for (let cell of data[i]) {
                    html += i === 0 ? `<th>${cell}</th>` : `<td>${cell}</td>`;
                }
                html += '</tr>';
            }

            html += '</table>';
            dataDisplay.innerHTML = html;
        }

        populateSheetSelector();
        sheetSelector.addEventListener('change', (e) => displaySheetData(e.target.value));

        // Display the first sheet by default
        if (workbook.SheetNames.length > 0) {
            displaySheetData(workbook.SheetNames[0]);
        }
    </script>
</body>
</html>